<?xml version="1.0"?>
<!-- Urdf format of the ARCL 5DOF spacecraft simulator. -->

<robot name="spacecraft_simulator">
  <link name="upper_stage">
    <inertial>
      <!-- Mass according to rough measuring of the full 5DOF sc
      upper stage -->
      <mass value="11.126"/>
      <!-- Sets up center of mass of link at the bottom of the ball joint -->
      <origin xyz="0 0 0.70078"/>
      <!-- Inertia according to solidworks model of the full 5DOF sc
      upper stage -->
      <inertia ixx="0.27" iyy="0.48" izz="0.25"
               ixy="0.00" ixz="0.02" iyz="0.00"/>
    </inertial>

    <visual>
      <origin xyz="0 0 0.70078"/>
      <geometry>
        <mesh filename="package://spacecraft_simulator_description/meshes/sc_top_ball.dae"/>
      </geometry>
    </visual>

    <collision>
      <!-- Determines position on link where collision is checked -->
      <origin xyz="0 0 0.10062"/>

      <geometry>
        <!-- <box size="0.4572 0.4572 0.19318"/> -->
        <mesh filename="package://spacecraft_simulator_description/meshes/sc_top_ball.dae"/>
      </geometry>
      <surface>
        <contact>
          <ode>
            <!-- Counts a collision at a minimum of 0.0 meters of overlap -->
            <min_depth>0.0</min_depth>
            <max_vel>0.5</max_vel>
          </ode>
        </contact>
        <friction>
          <ode>
            <mu>0.0</mu>
            <mu2>0.0</mu2>
          </ode>
        </friction>
      </surface>
    </collision>
  </link>

  <!-- Joint linking upper_stage and base_link, allowing for movement in 5DOF -->
  <joint name="base_link_anchor" type="revolute">
    <axis xyz="1 1 0"/>
    <limit effort="1000.0" lower="-0.7854" upper="0.7854" velocity="0.5"/>
    <origin xyz="0 0 0.74522" rpy="0 0 0"/>
    <parent link="upper_stage"/>
    <child link="base_link"/>
  </joint>

  <!-- Represents the spacecraft simulator model -->
  <link name="base_link">
    <inertial>
      <!-- Mass according to rough measuring of the full 5DOF sc
      upper stage -->
      <mass value="8.764"/>
      <!-- Sets up center of mass of link at the bottom of the ball joint -->
      <origin xyz="0 0 0.155"/>
      <!-- Inertia according to solidworks model of the full 5DOF sc
      upper stage -->
      <inertia ixx="3.79" iyy="0.20" izz="3.80"
               ixy="-0.12" ixz="0.01" iyz="-0.01"/>
    </inertial>

    <visual>
      <geometry>
        <mesh filename="package://spacecraft_simulator_description/meshes/sc_bot_ball_v2.dae"/>
      </geometry>
    </visual>

    <collision>
      <!-- Determines position on link where collision is checked -->
      <origin xyz="0 0 0"/>
      <geometry>
        <mesh filename="package://spacecraft_simulator_description/meshes/sc_bot_ball_v2.dae"/>
      </geometry>
      <surface>
        <contact>
          <ode>
            <!-- Counts a collision at a minimum of 0.0 meters of overlap -->
            <min_depth>0.0</min_depth>
            <max_vel>0.5</max_vel>
          </ode>
        </contact>
        <friction>
          <ode>
            <mu>0.0</mu>
            <mu2>0.0</mu2>
          </ode>
        </friction>
      </surface>
    </collision>
  </link>

  <gazebo>
    <!-- Plugin that controls movement of the model using forces at relative
    positions to the model's center of mass. Designed the model forces applied
    at specific thruster locations. -->
    <plugin name="thruster_force_controller" filename="libspacecraft_thruster16_force.so">
      <bodyName>upper_stage</bodyName>
      <topicName>thruster_force</topicName>
    </plugin>

    <plugin name="sc_model_pose" filename="libgazebo_ros_p3d.so">
      <alwaysOn>true</alwaysOn>
      <updateRate>100.0</updateRate>
      <bodyName>upper_stage</bodyName>
      <topicName>sc_pose</topicName>
      <gaussianNoise>0.0</gaussianNoise>
      <frameName>map</frameName>
      <xyzOffsets>0 0 0</xyzOffsets>
      <rpyOffsets>0 0 0</rpyOffsets>
    </plugin>
  </gazebo>

</robot>
